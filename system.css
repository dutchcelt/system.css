@layer system {
	@layer properties, selectors, modifiers;
	@layer properties {
		@property --system-cs-is-light {
			syntax: "<integer>";
			inherits: true;
			initial-value: 1; /* ON */
		}
		:root {
			/* TYPOGRAPHY */

			/* https://modernfontstacks.com */
			--system-font-family-display: system-ui, sans-serif;
			--system-font-family-data: system-ui, sans-serif;
			--system-font-family-interactive: system-ui, sans-serif;
			--system-font-family-body: Charter, 'Bitstream Charter', 'Sitka Text', Cambria, serif;
			--system-font-family-code: ui-monospace, 'Cascadia Code', 'Source Code Pro', Menlo, Consolas, 'DejaVu Sans Mono', monospace;

			--system-font-size: 112.5%; /* 112.5% => 18px */
			--system-line-height: 1.5;

			/**
			 * Font Size keywords
			 * https://developer.mozilla.org/en-US/docs/Web/CSS/font-size#values
			 */
			--system-font-size-xxxl: xxx-large;
			--system-font-size-xxl: xx-large;
			--system-font-size-xl: x-large;
			--system-font-size-l: large;
			--system-font-size-m: medium;
			--system-font-size-s: small;
			--system-font-size-xs: x-small;
			--system-font-size-xxs: xx-small;

			/**
			 * OpenType specification
			 * https://developer.mozilla.org/en-US/docs/Web/CSS/font-weight#common_weight_name_mapping
			 */
			--system-font-weight-thin: 100;
			--system-font-weight-extralight: 200;
			--system-font-weight-light: 300;
			--system-font-weight-normal: 400;
			--system-font-weight-medium: 500;
			--system-font-weight-semibold: 600;
			--system-font-weight-bold: 700;
			--system-font-weight-extrabold: 800;
			--system-font-weight-black: 900;


			/* COLORS */

			/**
			 * color-scheme state
			 *
			 * Example:
			 * color-mix(): Light mode is the first color value and dark mode the second.
			 * color: color-mix(in oklab, black var(--system-cs-state), white);
			 */
			--system-cs-state: calc(var(--system-cs-is-light, 1 /* fallback to light mode */) * 100%);

			/* System Colors */
			--system-accent-color: AccentColor;
			--system-accent-color-text: AccentColorText;
			--system-active-text: ActiveText;
			--system-button-border: ButtonBorder;
			--system-button-face: ButtonFace;
			--system-button-text: ButtonText;
			--system-canvas: Canvas;
			--system-canvas-text: CanvasText;
			--system-field: Field;
			--system-field-text: FieldText;
			--system-gray-text: GrayText;
			--system-highlight: Highlight;
			--system-highlight-text: HighlightText;
			--system-link-text: color-mix(in oklab, LinkText var(--system-cs-state), color-mix(in oklab, LinkText 60%, var(--system-canvas-text)));
			--system-mark: Mark;
			--system-mark-text: MarkText;
			--system-selected-item: SelectedItem;
			--system-selected-item-text: SelectedItemText;
			--system-visited-text: color-mix(in oklab, VisitedText var(--system-cs-state), color-mix(in oklab, VisitedText 60%, var(--system-canvas-text)));

			/* Additional Colors */
			/* These are only mixed with system colors */
			--system-dark-grey: color-mix(in oklab, Canvas 95%, CanvasText);
			--system-mid-grey: color-mix(in oklab, CanvasText 85%, Canvas);
			--system-grey: color-mix(in oklab, Canvas  75%, CanvasText);
			--system-canvas-text-inverted: color-mix(in oklab, Canvas var(--system-cs-state), CanvasText);

			/* System Spacing */
			--system-spacing-layout: 2rem;
			--system-spacing-content: 1em;
			--system-spacing-heading: 1em;
			--system-spacing-form: 1em;
			--system-spacing-field: 1em;
			--system-spacing-button: 1em;
			--system-dimension-content: 85ch;

		}
	}
	@layer modifiers {
		@media (prefers-color-scheme: dark) {
			:root {
				--system-cs-is-light: 0; /* OFF */
			}
		}
	}
	@layer selectors {
		html {
			font-family: var(--system-font-family-body);
			font-size: var(--system-font-size);
			line-height: var(--system-line-height);
			color-scheme: light dark;
		}
		body {
			--viewport-padding: minmax(1rem, 1fr);
			--content-width: minmax(calc(325px - 2rem), 85ch);

			display: grid;
			grid-template-columns: [--viewport-start] var(--viewport-padding) [--content-start] var(--content-width) [--content-end] var(--viewport-padding) [--viewport-end];
			margin: 0;
		}
		body > :is(header,footer) {
			display: grid;
			grid-template-columns: subgrid;
			grid-column:  --viewport-start / --viewport-end;
			padding-block: var(--system-spacing-layout);
			& > * {
				grid-column: --content-start / --content-end;
				margin: 0;
				padding:0;
			}
		}
		main {
			/* Center main in page */
			grid-column: --content-start / --content-end;
		}

		body > header {
			background: var(--system-dark-grey);
			border-block-end: thin solid var(--system-grey);
		}
		body > :is(header,main,footer):not(:has(*)) {
			display: none;
		}

		::selection {
			background: var(--system-highlight);
			color: var(--system-highlight-text);
		}

		:is(h1,h2,h3,h4,h5,h6) {
			font-family: var(--system-font-family-display);
			line-height: 1.1;
			color: var(--system-canvas-text);
			margin-block-start: max(2rem, 2.5ex);
			margin-block-end: max(1rem, 1ex);
		}

		:is(h1,h2,h3) {
			text-wrap: balance;
		}
		:is(h4,h5,h6) {
			line-height: 1.2;
		}

		h1 {
			font-size: var(--system-font-size-xxxl);
		}

		h2 {
			font-size: var(--system-font-size-xxl);
		}

		h3 {
			font-size: var(--system-font-size-xl);
		}

		h4 {
			font-size: var(--system-font-size-l);
		}

		h5 {
			font-size: var(--system-font-size-m);
		}

		h6 {
			font-size: var(--system-font-size-s);
			text-transform: uppercase;
		}

		a {
			color: var(--system-link-text);
		}

		a:hover {
			color: color-mix(in oklab, var(--system-link-text) 80%, CanvasText);
		}
		a:active {
			color: var(--system-active-text);
		}
		a:focus {
			color: var(--system-link-text);
		}
		a:visited {
			color: var(--system-visited-text, VisitedText);
		}

		abbr:hover {
			/* Set the '?' cursor while hovering an abbreviation */
			cursor: help;
		}

		blockquote {
			padding: 1.5rem;
			background: var(--system-dark-grey);
			border-inline-start: 5px solid var(--system-grey);
			& *:last-child {
				padding-block-end: 0;
				margin-block-end: 0;
			}
		}

		abbr {
			cursor: help;
		}


		input, select, button, textarea {
			font-family: var(--system-font-family-interactive);
		}

		button {
			font-size: var(--system-font-size-m);
			display: inline-block;
			padding: 6px 12px;
			text-align: center;
			text-decoration: none;
			background: var(--system-button-face);
			color: var(--system-button-text);
			white-space: nowrap;
			border: 0;
			border-radius: 4px;
			box-sizing: border-box;
			cursor: pointer;
			&:hover{
				background: color-mix(in oklab, var(--system-button-face) 90%, CanvasText);
			}
		}
		button[type="submit"]{
			background: var(--system-accent-color);
			color: var(--system-canvas-text-inverted);
			&:is(:focus,:enabled:hover){
				color: var(--system-canvas-text-inverted);
				background: color-mix(in oklab, var(--system-accent-color) 85%, CanvasText);
			}

		}
		button[disabled]{
			opacity: .3333;
			cursor: not-allowed;
			&:hover{
				background: var(--system-button-face);
				color: var(--system-button-text);
			}
		}


		a img, a svg {
			margin-block-end: 0px;
		}

		code,
		pre,
		kbd,
		samp {
			/* Set the font family for monospaced elements */
			font-family: var(--system-font-family-code);
		}

		code,
		samp,
		kbd,
		pre {
			/* The main preformatted style. This is changed slightly across different cases. */
			background: var(--system-dark-grey);
			border: thin solid var(--system-grey);
			border-radius: 4px;
			padding: 3px 6px;
			/* ↓ font-size is relative to containing element, so it scales for titles*/
			font-size: var(--system-font-size-s);
		}

		kbd {
			/* Makes the kbd element look like a keyboard key */
			border-block-end: 3px solid var(--system-grey);
		}

		pre {
			padding: 1rem 1.4rem;
			max-width: 100%;
			overflow: auto;
		}

		pre code {
			/* When <code> is in a <pre>, reset it's formatting to blend in */
			background: inherit;
			font-size: inherit;
			color: inherit;
			border: 0;
			padding: 0;
			margin: 0;
		}

		code pre {
			/* When <pre> is in a <code>, reset it's formatting to blend in */
			display: inline;
			background: inherit;
			font-size: inherit;
			color: inherit;
			border: 0;
			padding: 0;
			margin: 0;
		}

		details {
			/* Make the <details> look more "clickable" */
			padding: .6rem 1rem;
			background: var(--system-dark-grey);
			border: 1px solid var(--system-grey);
			border-radius: 4px;
		}

		summary {
			/* Makes the <summary> look more like a "clickable" link with the pointer cursor */
			cursor: pointer;
			font-weight: var(--system-font-weight-bold);
		}

		details[open] {
			/* Adjust the <details> padding while open */
			padding-block-end: .75rem;
		}

		details[open] summary {
			/* Adjust the <details> padding while open */
			margin-block-end: 6px;
		}

		details[open] > *:last-child {
			/* Resets the bottom margin of the last element in the <details> while <details> is opened. This prevents double margins/paddings. */
			margin-block-end: 0;
		}

		dt {
			font-weight: var(--system-font-weight-bold);
		}

		dd::before {
			/* Add an arrow to data table definitions */
			content: '→ ';
		}

		hr {
			/* Reset the border of the <hr> separator, then set a better line */
			border: 0;
			border-block-end: medium solid var(--system-dark-grey);
			margin: 2rem 0;
		}

		fieldset {
			display: flex;
			flex-direction: column;
			position: relative;
			border: 0;
			padding: 0;
			margin: 0;
			&:has(legend){
				margin-block-start: calc(1ex - 0.5lh);
				margin-block-end: 1ex;
				padding-block-start: 0.5lh;
			}
			}
		form > div:has(button){
			margin-block-start: 1rem;
		}
		legend {
			position: relative;
			inset: 0.5lh 0;
		}
		fieldset:has(:user-invalid),
		form:has(:user-invalid),
		form :user-invalid:not(:focus-visible) {
			accent-color: crimson;
			outline: thin solid crimson;
			&:is(fieldset) {
				outline:0;
				box-shadow:-13px 0 0 var(--system-canvas), -16px 0 0 crimson;
			}
			&:is(form) {
				outline:0;
				box-shadow:-14px 0 0 var(--system-canvas), -15px 0 0 color-mix(in oklab, crimson 50%, var(--system-canvas));
			}

		}

		fieldset > :is(p,div,fieldset) {
			display: flex;
			flex-direction: column;
			align-items: start;
			justify-items: start;
			margin-block: calc((1lh - 1em) / 2);
			gap: calc((1lh - 1em) / 2);
			border: 0;
			padding: 0;
			&:has([type="checkbox"], [type="radio"]) {
				display: grid;
				grid-template-columns: min-content 1fr;
				row-gap: calc(1em - 1ex);
				column-gap: 1ch;
				padding-block:calc(1em - 1ex);
				font-family: var(--system-font-family-data);
				line-height: 1;
			}
			&:is(fieldset):has(:user-valid) {
				& input {
					accent-color: initial;
					outline: 0;
				}
			}

		}
		table {
			/* border-collapse sets the table's elements to share borders, rather than floating as separate "boxes". */
			border-collapse: collapse;
			width: 100%;
			font-family: var(--system-font-family-data);
		}

		td,
		th {
			border: thin solid var(--system-grey);
			text-align: left;
			padding: .5rem;
		}

		th {
			background: var(--system-dark-grey);
		}

		tr:nth-child(even) {
			/* Set every other cell slightly darker. Improves readability. */
			background: var(--system-dark-grey);
		}

		table caption {
			font-weight: var(--system-font-weight-bold);
			margin-block-end: .5rem;
		}

		textarea {
			/* Don't let the <textarea> extend off the screen naturally or when dragged by the user */
			max-width: 100%;
		}

		ol,
		ul {
			/* Replace the browser default padding */
			padding-inline-start: 2rem;
		}

		li {
			margin-block-start: .4rem;
		}

		ul ul,
		ol ul,
		ul ol,
		ol ol {
			margin-block-end: 0;
		}

		mark {
			padding: 3px 6px;
			background: var(--system-mark);
			color: var(--system-mark-text);
		}

		textarea,
		select,
		input {
			padding: 6px 12px;
			margin-block-end: .5rem;
			background: var(--system-field);
			color: var(--system-field-text);
			border: thin solid var(--system-grey);
			border-radius: 4px;
			box-shadow: none;
			box-sizing: border-box;
			font-size: 1rem;
			accent-color: var(--system-accent-color);
			&:is([type='radio']){
				border-radius: 50%;
			}
		}

		figure {
			margin-block: 1rem;
			margin-inline: 0;
		}
		figcaption {
			text-align: center;
			font-style: italic;
			font-size: var(--system-font-size-s);
		}
		img, svg {
			max-width: 100%;
		}
	}
}


